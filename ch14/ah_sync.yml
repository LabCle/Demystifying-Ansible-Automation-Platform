---
- name: Add user, group, and user to group
  hosts: localhost
  connection: local
  gather_facts: false
  collections:
    - redhat_cop.ah_configuration
  tasks:
    - name: Configure rh-certified repo
      redhat_cop.ah_configuration.ah_repository:
        name: rh-certified
        url: https://cloud.redhat.com/api/automation-hub/
        token: token
        auth_url: https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token
        ah_host: https://ah.node
        ah_username: admin
        ah_password: secret123
        ah_path_prefix: galaxy
        validate_certs: false

    - name: Configure community repo
      ah_repository:
        name: community
        url: https://galaxy.ansible.com/api/
        requirements:
          - redhat_cop.ah_configuration
          - redhat_cop.tower_configuration
        ah_host: https://ah.node
        ah_username: admin
        ah_password: secret123
        ah_path_prefix: galaxy
        validate_certs: false

    - name: Configure community repo from a file
      ah_repository:
        name: community
        url: https://galaxy.ansible.com/api/
        requirements_file: "requirements.yml"
        ah_host: https://ah.node
        ah_username: admin
        ah_password: secret123
        ah_path_prefix: galaxy
        validate_certs: false